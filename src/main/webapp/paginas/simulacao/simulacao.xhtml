<ui:composition template="/WEB-INF/templates/template.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

	<ui:define name="html-head">
		<h:outputScript library="js" name="plateDraw.js" />

		<script type="text/javascript" src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization',
			   'version':'1','packages':['timeline']}]}"></script>
		
		<script type="text/javascript">
			function drawChart() {
			  var container = document.getElementById('example1');
	
			  var chart = new google.visualization.Timeline(container);
	
			  var dataTable = new google.visualization.DataTable();
	
			  dataTable.addColumn({ type: 'string', id: 'Processo' });
			  dataTable.addColumn({ type: 'number', id: 'Start' });
			  dataTable.addColumn({ type: 'number', id: 'End' });
	
			  dataTable.addRows([
				[ 'Firefox', 0, 5000 ],
				[ 'Chrome',  6000, 10000],
				[ 'Safari',  11000, 24000 ],
				[ 'Firefox', 25000, 28000 ],]);
	
			  chart.draw(dataTable);
			}
		</script>
	</ui:define>
	
	<ui:define name="content-main-page">
		<h3 style="margin-bottom: 5px;">Simulação</h3>
		
		<p:messages id="formSimulacaoMessage" autoUpdate="false"/>
			
		<h:form id="formSimulacao">
			<p:focus for="formSimulacao"/>

		    <p:panelGrid columns="3" styleClass="panelgrid" id="simulaProcessosPanel">
        		
        		<h:panelGroup>
        			<label><h:outputText value="#{bundle['simulacao.label.controle.tempo']}" style="vertical-align: super;"/></label>
        		
        			<p:spacer width="10" />
					<p:selectOneMenu id="selectTrocaContexto" styleClass="tam_m">
		            	<f:selectItem itemLabel="Auto" itemValue="1" />
		            	<f:selectItem itemLabel="Manual" itemValue="2" />
		            	<f:selectItem itemLabel="Por Incremento" itemValue="3" />
					</p:selectOneMenu>
				</h:panelGroup>
				
				<h:panelGroup id="groupAuto" rendered="true">
					<p:commandButton icon="ui-icon-play" value="Iniciar" styleClass="btn" onclick="drawChart();"/>
					<p:commandButton icon="ui-icon-stop" value="Parar" styleClass="btn" onclick="clearChart();"/>
				</h:panelGroup>
				
				<h:panelGroup id="groupManual" rendered="false">	
					<p:commandButton value="Avançar" styleClass="btn"/>
				</h:panelGroup>
				
				<h:panelGroup id="groupIncremento" rendered="false">
					Quantidade de tempo <p:inputText styleClass="tam_p"/> 
					<p:commandButton value="Avançar" styleClass="btn"/>
				</h:panelGroup>
        	</p:panelGrid>
	        
			<p:tabView activeIndex="#{maquinaSessaoController.activeAba}">
		        <p:tab title="Processos">
					
		        	<div align="right" class="tempo-simulacao" >
			        	<label><h:outputText value="Tempo: 28"/></label>
			        </div>
					
		        	<p:fieldset legend="CPU">
		        		<p:panelGrid columns="4" styleClass="panelgrid" id="simulaProcessosPanel">
			        		<p:outputLabel value="IR">
			        			<br/>
				        		<p:inputText value="#{40}" disabled="true" styleClass="tam_p"/>
			        		</p:outputLabel>
	
			        		<p:outputLabel value="PC">
			        			<br/>
				        		<p:inputText value="#{15}" disabled="true" styleClass="tam_p"/>
			        		</p:outputLabel>
			        		
			        		<p:outputLabel value="PID - Processo Atual">
			        			<br/>
				        		<p:inputText value="1 - Firefox" disabled="true" styleClass="tam_g"/>
			        		</p:outputLabel>
			        		
			        	</p:panelGrid>
		        	</p:fieldset>	
<!-- 					
					<p:dataTable var="processo" value="#{fatController.listaProcessos}">
					    <p:column headerText="PID" width="10%">
					        <h:outputText value="#{processo.id}" />
					    </p:column>
					    <p:column headerText="Nome" width="35%">
					        <h:outputText value="#{processo.nome}"/>
					    </p:column>
					    <p:column headerText="Nº de Instruções" width="20%">
					        <h:outputText value="#{processo.nInstrucoes}" />
					    </p:column>
					    <p:column headerText="Estado" width="20%">
					        <h:outputText value="#{processo.estado}" />
					    </p:column>
					    <p:column headerText="Ações" width="15%" styleClass="column-align-center">
					    	<p:commandButton icon="ui-icon-cancel"  title="Finalizar" styleClass="icon-grid-margin"/>
							<p:commandButton icon="ui-icon-pause" title="Pausar" styleClass="icon-grid-margin"/>
					    </p:column>
					</p:dataTable> -->
					
					<br/>
					<div id="example1" style="width: 100%; height: 180px;"></div>
					
		        </p:tab>
		        <p:tab title="Memória">
		        	<div align="right" class="tempo-simulacao" >
			        	<label><h:outputText value="Tempo: 10"/></label>
			        </div>
		        </p:tab>
		        <p:tab title="Disco">
		        	<div align="right" class="tempo-simulacao" >
			        	<label><h:outputText value="Tempo: 10"/></label>
			        </div>
					<p:commandButton value="Adicionar Arquivo" styleClass="btn" onclick="modalNovoProcesso.show()"/>
					
					
					<p:dataTable var="arquivo" value="#{maquinaSessaoController.sistemaArquivo.allFiles}" id="dataFat">
						<f:facet name="header">
					        Tabela de Arquivos
					    </f:facet>
				        <p:column headerText="ID">
				        	<h:outputText value="#{arquivo.fileID}" />
				        </p:column>
				        <p:column headerText="Nome">
				        	<b><h:outputText value="#{arquivo.fileName}" style="color: ##{arquivo.color}"/></b>
				        </p:column>
				        <p:column headerText="Setores alocados">
				        	<h:outputText value="#{arquivo.allocatedSectors}" />
				        </p:column>
				        <p:column headerText="Iniciar">
				        	<p:commandButton icon="ui-icon-play"  title="Inicializar" styleClass="icon-grid-margin"/>
				        	<p:commandButton icon="ui-icon-trash" title="Excluir" actionListener="#{maquinaSessaoController.deleteFile(arquivo.fileID)}" update=":formSimulacao :formSimulacaoMessage" />
				        </p:column>
				    </p:dataTable>
				    <p:spacer height="15px"/>
					
					<div class="tempo-simulacao" >
						Tamanho do setor: #{discoController.sectorSize} bytes | Tamanho do disco: #{discoController.diskSize/1024} KB. | Quantidade de setores: #{discoController.qtdSectors}
					</div>
					
	        	   	<p:dataGrid var="prato" value="#{discoController.hardDisck.hd}" rows="9" paginator="true" id="dataPrato"
				        paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
				        paginatorPosition="bottom"
				        rowsPerPageTemplate="9,18,32" rowIndexVar="index">
				 
				        <f:facet name="header">Disco Rígido</f:facet>
				        
				        <p:panel header="Prato #{index+1}" style="text-align:center">
				        
				        	<canvas id="canvas#{index}" width="200px" height="200px" />
							
							<!-- <script>plateDraw('canvas#{index}', new Array('#f70808','#f70808','#f70808','#f70808'), new Array('#f70808','#f70808','#f70808','#f70808'));</script> -->												        	
				        	<script>#{discoController.drawPlates(prato, index)}</script>
				        	
				        	
				        	<!-- <table border="1" style="width: 100%;">
				        		<tr>
				        			<td></td>
				        			<td><b>Setor 1</b></td>
				        			<td><b>Setor 2</b></td>
				        			<td><b>Setor 3</b></td>
				        			<td><b>Setor 4</b></td>
				        		</tr>
					        	<ui:repeat varStatus="status" var="track" value="#{prato.tracks}">
					        		<tr>
					        			<td><b>Trilha #{status.index}</b></td>
					        			<ui:repeat varStatus="k" var="sector" value="#{track.sectors}">
					        				<td style="background-color: ##{(discoController.obterArquivo((index*8)+ (status.index *4) + k.index)).getColor()}">
					        					#{(discoController.obterArquivo((index*8)+ (status.index *4) + k.index)).getFileName()}
					        				</td>
					        			</ui:repeat>		
					        		</tr>
					        	</ui:repeat>
				        	</table> -->
				        </p:panel>
				    </p:dataGrid>
		        </p:tab>
		        <p:tab title="Gráficos">
		        </p:tab>
		    </p:tabView>
		    <br/>
		</h:form>
		
		<p:dialog id="novo-processo" widgetVar="modalNovoProcesso" header="Upload de Arquivo" width="600px" height="auto" resizable="false" modal="true">
			<h:form enctype="multipart/form-data">
				<p:panelGrid columns="1" styleClass="panelgrid" id="criarProcesso">
					
			    	<p:outputLabel value="Arquivo">
			    		<br/>
			    		<p:fileUpload value="#{maquinaSessaoController.uploadFile}" mode="simple" />
			    	</p:outputLabel>
			    	<p:outputLabel value="Cor de exibição">
			    		<br/>
	        			<p:colorPicker value="#{maquinaSessaoController.color}" /> 
			    	</p:outputLabel>
			    	
    				<p:commandButton value="Criar" ajax="false" actionListener="#{maquinaSessaoController.doUploadFile}" update=":formSimulacao :formSimulacaoMessage" />
    			</p:panelGrid>
			</h:form>
		</p:dialog>
		
	</ui:define>
</ui:composition>
